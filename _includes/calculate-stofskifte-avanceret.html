{% comment %}
<script>
    function calculate(form) {
        var bmr;
        var age = parseInt(form.age.value);
        var weight = parseInt(form.weight.value);
        var height = parseInt(form.height.value); // convert to meters
        var sex = form.sexHidden.value;

        // Værdier baseret på Schofield
        if (sex == "male") {
            if ((age > 0) && (age < 3)) {
                bmr = 249 * weight - 127;
            }
            else if ((age > 2) && (age < 11)) {
                bmr = 95 * weight + 2110;
            }
            else if ((age > 10) && (age < 19)) {
                bmr = 74 * weight + 2754;
            }
            else if ((age > 18) && (age < 31)) {
                bmr = 63 * weight + 2896;
            }
            else if ((age > 30) && (age < 61)) {
                bmr = 48 * weight + 3653;
            }
            else if ((age > 60)) {
                bmr = 49.9 * weight + 2930;
            }
        }
        else if (sex == "female") {
            if ((age > 0) && (age < 3)) {
                bmr = 244 * weight - 130;
            }
            else if ((age > 2) && (age < 11)) {
                bmr = 85 * weight + 2033;
            }
            else if ((age > 10) && (age < 19)) {
                bmr = 56 * weight + 2898;
            }
            else if ((age > 18) && (age < 31)) {
                bmr = 62 * weight + 2036;
            }
            else if ((age > 30) && (age < 61)) {
                bmr = 34 * weight + 3538;
            }
            else if ((age > 60)) {
                bmr = 38 * weight + 2755;
            }
        }

        var basicMeta = bmr;
        var BMR = bmr;
	    
        var min_day = 24 * 60;
        var activity_intense = document.getElementById('activity_intense').value;
        var activity_moderat = document.getElementById('activity_moderat').value;
        var activity_light = document.getElementById('activity_light').value;
        var activity_standing = document.getElementById('activity_standing').value;
        var activity_sleeping = document.getElementById('activity_sleeping').value;

        var activity_sitting = min_day - activity_intense - activity_moderat - activity_light - activity_standing - activity_sleeping;

        // My own PAL calculation - there is no weight factor
        var met_intense = 10;
        var met_moderat = 7;
        var met_light = 4;
        var met_standing = 2;
        var met_sleeping = 0.9;
        var met_sitting = 1.2;
        
        var pal_intense = (met_intense * (activity_intense / 1440));
        var pal_moderat = (met_moderat * (activity_moderat / 1440));
        var pal_light = (met_light * (activity_light / 1440));
        var pal_standing = (met_standing * (activity_standing / 1440));
        var pal_sleeping = (met_sleeping * (activity_sleeping / 1440));
        var pal_sitting = (met_sitting * (activity_sitting / 1440));

        var pal = pal_intense + pal_moderat + pal_light + pal_standing + pal_sleeping + pal_sitting;
        
        /*
        // Calculate MET-energy
        var met_energy_intense = weight * (met_intense * (activity_intense / 60));
        var met_energy_moderat = weight * (met_moderat * (activity_moderat / 60));
        var met_energy_light = weight * (met_light * (activity_light / 60));
        var met_energy_standing = weight * (met_standing * (activity_standing / 60));
        var met_energy_sitting = weight * (met_sitting * (activity_sitting / 60));
        
        var met_energy = met_energy_intense + met_energy_moderat + met_energy_light + met_energy_standing + met_energy_sitting;
        */

        // Calculate PAL from Gerrior
        var bmr_kcal = basicMeta / 4.2; // BMR is in kcal in formula
        var pal_intense = ((met_intense - 1) * ((1.15 / 0.9) * activity_intense) / 1440) / (bmr_kcal / (0.0175 * 1440 * weight));
        var pal_moderat = ((met_moderat - 1) * ((1.15 / 0.9) * activity_moderat) / 1440) / (bmr_kcal / (0.0175 * 1440 * weight));
        var pal_light = ((met_light - 1) * ((1.15 / 0.9) * activity_light) / 1440) / (bmr_kcal / (0.0175 * 1440 * weight));
        var pal_standing = ((met_standing - 1) * ((1.15 / 0.9) * activity_standing) / 1440) / (bmr_kcal / (0.0175 * 1440 * weight));
        var pal_sleeping = ((met_sleeping - 1) * ((1.15 / 0.9) * activity_sleeping) / 1440) / (bmr_kcal / (0.0175 * 1440 * weight));
        var pal_sitting = ((met_sitting - 1) * ((1.15 / 0.9) * activity_sitting) / 1440) / (bmr_kcal / (0.0175 * 1440 * weight));
        var pal_gerrior = 1.1 + pal_intense + pal_moderat + pal_light + pal_standing + pal_sleeping + pal_sitting;

        // Using Gerrior PAL calculations as constant
        var activityConstant = pal_gerrior;

        var vedligehold = basicMeta * activityConstant;
        document.getElementById('pal_gerrior').value = pal_gerrior;
        document.getElementById('activity_sitting').value = activity_sitting;
        document.getElementById('bmr').value = basicMeta + " kJ";
        document.getElementById('equilibrium').value = vedligehold + " kJ";
        return false;
    }
</script>
{% endcomment %}
<form class="calculator" id="calculator_bmr_advanced_pal">
    <fieldset>
        <legend>Avanceret udregning af dit stofskifte, energibehov og ligevægtsindtag baseret på Schofield (1985).</legend>
        <fieldset>
            <legend>Køn</legend>
            <label for="male" class="radio"><input type="radio" name="sex" value="male" id="male" onclick="this.form.gender.value = 'male';" checked="checked"> Mand</label>
    		<label for="female" class="radio"><input type="radio" name="sex" value="female" id="female" onclick="this.form.gender.value = 'female';"> Kvinde</label>
    		<input type="hidden" name="gender" value="male">
        </fieldset>
        <div class="form-group">
            <label for="age">Alder (år)</label>
            <input type="number" min="10" max="100" placeholder="fx 40" name="age" id="age">
        </div>
        <div class="form-group">
            <label for="weight">Vægt (kg)</label>
            <input type="number" min="10" max="200" placeholder="fx 70" name="weight" id="weight" step="0.1">
        </div>
        <div class="form-group">
            <label for="height">Højde (cm)</label>
            <input type="number" min="10" max="240" placeholder="fx 170" name="height" id="height" step="0.1">
        </div>
        <fieldset>
            <legend>Angiv dit daglige fysiske aktivitetsniveau</legend>
        <div class="form-group">
            <label for="height">Intens træning (min) - MET 10</label>
            <input type="number" min="0" max="1440" placeholder="" name="activity_intense" id="activity_intense">
            <p class="help-block">Maksimal aktivitet. Intensiv idræt. Hurtig løb. Hurtig roning.</p>
        </div>
        <div class="form-group">
            <label for="height">Moderat træning (min) - MET 7</label>
            <input type="number" min="0" max="1440" placeholder="" name="activity_moderat" id="activity_moderat">
            <p class="help-block">Styrketræning. Hugge brænde. De fleste idrætsgrene. Cykling.</p>
        </div>
        <div class="form-group">
            <label for="height">Let aktivitet (min) - MET 4</label>
            <input type="number" min="0" max="1440" placeholder="" name="activity_light" id="activity_light">
            <p class="help-block">Husarbejde. Havearbejde. Hurtig gang. Golf.</p>
        </div>
        <div class="form-group">
            <label for="height">Stående og gående (min) - MET 2</label>
            <input type="number" min="00" max="1440" placeholder="" name="activity_standing" id="activity_standing">
            <p class="help-block">Madlavning. Let gang. Indkøb. Shopping.</p>
        </div>
        <div class="form-group">
            <label for="height">Sove (min) - MET 0,9</label>
            <input type="number" min="0" max="1440" placeholder="" name="activity_sleeping" id="activity_sleeping">
            <p class="help-block">Fra du ligger i sengen til du står op.</p>
        </div>
        <div class="form-group">
            <label for="height">Siddende (min) - MET 1,2</label>
            <input type="number" min="0" max="1440" value="1440" name="activity_sitting" id="activity_sitting" disabled="disabled">
            <p class="help-block">Den resterende tid anslås som siddende.</p>
        </div>
        </fieldset>
        <input type="submit" value="Beregn">
    </fieldset>
    <fieldset class="results">
        <div class="form-group">
            <label for="pal_gerrior">Physical Activity Level (PAL)</label>
            <input name="pal_gerrior" id="pal_gerrior" disabled="disabled">
        </div>
        <div class="form-group">
            <label for="bmr">Basalstofskifte og hvilestofskifte (BMR) (kJ)</label>
            <input name="bmr" id="bmr" disabled="disabled">
        </div>
        <div class="form-group">
            <label for="equilibrium">Energiforbrug og stofskifte på en dag (kJ)</label>
            <input name="equilibrium" id="equilibrium" disabled="disabled">
        </div>
        <div class="form-group">
            <label for="tee">Energiforbrug - Korrigeret for vægt og BMI (kJ)</label>
            <p class="help-block">Jeg vil gerne forsøge at lave en beregner, der kan korrigere for alder, vægt og BMI i forhold til nogle af de <a href="http://health-calc.com/diet/energy-expenditure-advanced">ideer Morten Zacho præsenterer</a>. Hvis du har en ide til nogle <em>open source</em>-korrektioner, som er baseret på videnskab, så hører jeg meget gerne fra dig.</p>
        </div>
    </fieldset>
</form>
